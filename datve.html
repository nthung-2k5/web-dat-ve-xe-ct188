<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="author" content="Hồ Thị Dứa">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/icon.png" rel="icon" type="image/vnd.microsoft.icon">
    <title>Đặt vé xe</title>

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script>
        // Nếu người dùng chưa đăng nhập, chuyển hướng đến trang đăng nhập
        // và lưu lại đường dẫn hiện tại để sau khi đăng nhập có thể quay lại trang này
        const currentUser = sessionStorage.getItem('currentUser') ?? localStorage.getItem('currentUser');
        if (!currentUser) {
            window.location.href = `/dangnhap.html?redirectUrl=${encodeURIComponent(window.location.pathname + window.location.search)}`;
        }
    </script>

    <script defer src="/scripts/web-layout.js"></script>
    <script type="module" src="/scripts/datve/preload.js"></script>
    <script type="module" src="/scripts/datve/index.js"></script>
    <link
        href="https://cdn.jsdelivr.net/combine/npm/daisyui@5/base/svg.css,npm/daisyui@5/base/scrollbar.css,npm/daisyui@5/base/rootcolor.css,npm/daisyui@5/base/rootscrolllock.css,npm/daisyui@5/base/rootscrollgutter.css,npm/daisyui@5/base/properties.css,npm/daisyui@5/components/button.css,npm/daisyui@5/components/menu.css,npm/daisyui@5/components/select.css,npm/daisyui@5/components/toggle.css,npm/daisyui@5/components/label.css,npm/daisyui@5/components/checkbox.css,npm/daisyui@5/components/input.css,npm/daisyui@5/components/card.css,npm/daisyui@5/theme/light.css"
        rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="/styles/main.css" />

    <style type="text/tailwindcss">
        .seat {
            @apply relative transition cursor-pointer size-[40px];

            > span {
                @apply absolute inset-0 flex items-center justify-center text-sm font-semibold;
            }

            &.selected {
                @apply text-purple-900;
            }

            &.available {
                @apply text-sky-900;
            }

            &.occupied {
                cursor: not-allowed;
                @apply text-gray-900;
            }

            &:hover:not(.occupied):not(.selected) {
                @apply scale-110;
            }
        }

        .seat-row {
            display: flex;
            justify-content: center;
            align-items: center;
            @apply gap-2;
        }

        .legend {
            @apply flex items-center;
        }

        .legend-box {
            @apply inline-block w-4 h-4 mr-2 rounded border-2;
        }

        input.input {
            &:valid {
                border-color: #28a745;
                padding-right: calc(1.5em + 0.75rem);
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2328a745' d='M2.3 6.73L.6 4.53c-.4-.4-.4-1.03 0-1.4.4-.4 1.03-.4 1.4 0l1.7 1.7L6.2 2.3c.4-.4 1.03-.4 1.4 0 .4.4.4 1.03 0 1.4L3.7 6.73c-.4.4-1.03.4-1.4 0z'/%3e%3c/svg%3e");
                background-repeat: no-repeat;
                background-position: right calc(0.375em + 0.1875rem) center;
                background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
            }

            &:invalid {
                border-color: #dc3545;
                padding-right: calc(1.5em + 0.75rem);
                background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle r='.5' cx='6' cy='8.2'/%3e%3c/svg%3e");
                background-repeat: no-repeat;
                background-position: right calc(0.375em + 0.1875rem) center;
                background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
            }
        }

        .valid-feedback,
        .invalid-feedback {
            display: none !important;
        }

        .form-group {
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <main class="container my-5 mx-auto">
        <form class="grid grid-cols-1 columns-2 lg:grid-cols-[2fr_1fr] gap-4" novalidate method="GET" action="/datvethanhcong.html">
            <input type="hidden" name="routeId">
            <input type="hidden" name="seats">
            <div class="card bg-white max-lg:order-1">
                <div class="card-body items-center">
                    <h3 class="card-title">🪑 Chọn ghế</h3>
                    <div class="flex justify-center gap-6 mb-2">
                        <span class="legend">
                            <div class="legend-box border-[#96C5E7] bg-[#DEF3FF]"></div> Còn trống
                        </span>
                        <span class="legend">
                            <div class="legend-box border-[#B795E0] bg-[#F1E5FF]"></div> Đang chọn
                        </span>
                        <span class="legend">
                            <div class="legend-box border-[#C0C6CC] bg-[#D5D9DD]"></div> Đã bán
                        </span>
                    </div>
                    <div class="flex flex-col gap-2" id="seatContainer"></div>
                </div>
            </div>
            <div class="row-span-2 hidden lg:flex flex-col gap-4" id="rightCol">
                <div class="card bg-white max-lg:order-2" id="customerInfo">
                    <div class="card-body items-center">
                        <h3 class="card-title">👤 Thông tin khách hàng</h3>
                        <div class="grid grid-cols-1 gap-4 w-full">
                            <label class="floating-label">
                                <span>🪪 Họ và tên</span>
                                <input name="name" placeholder="🪪 Họ và tên" pattern="^[a-zA-ZÀ-ỹ\s]+$" required
                                    class="input input-md min-w-full">
                            </label>
                            <label class="floating-label">
                                <span>📞 Số điện thoại</span>
                                <input name="phone" placeholder="📞 Số điện thoại" pattern="^0[0-9]{9}$" required
                                    class="input input-md min-w-full">
                            </label>
                            <label class="floating-label">
                                <span>📧 Email</span>
                                <input id="email" name="email" placeholder="📧 Email" type="email" required
                                    class="input input-md min-w-full">
                            </label>
                        </div>
                    </div>
                </div>
                <div class="card bg-white max-lg:order-4" id="orderInfo">
                    <div class="card-body items-center">
                        <h3 class="card-title">🚌 Thông tin vé</h3>
                        <div class="w-full text-base grid grid-cols-1 gap-2">
                            <p><strong>🛣️Tuyến xe:</strong> <span id="route-display"></span></p>
                            <p><strong>⏰Thời gian xuất phát:</strong> <span id="departure-time-display"></span></p>
                            <p><strong>💺Số lượng ghế:</strong> <span id="seat-count-display">0 Ghế</span></p>
                            <p><strong>🔢Số ghế:</strong> <span id="seat-numbers-display">Chưa chọn</span></p>
                            <p><strong>📍Điểm đón khách:</strong> <span id="pickup-location-display"></span></p>
                            <p><strong>📍Điểm trả khách:</strong> <span id="arrival-location-display"></span></p>
                            <p><strong>💰Tổng tiền:</strong> <span id="total-price-display">0</span>đ</p>
                            <div class="flex justify-between mt-4">
                                <button type="reset" class="btn btn-outline btn-error">🔄Đặt lại</button>
                                <button type="submit" class="btn btn-info">💳 Thanh toán</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card bg-white max-lg:order-3">
                <div class="card-body items-center">
                    <h3 class="card-title">📌 Điều khoản &amp; Lưu ý</h3>
                    <div class="w-full">
                        <p class="mb-2">(*) Quý khách vui lòng có mặt tại bến xuất phát của xe trước ít nhất 30 phút giờ
                            xe khởi hành, mang theo thông báo đã thanh toán vé thành công có chứa mã vé được gửi từ hệ
                            thống Route3Go. Vui lòng liên hệ Trung tâm tổng đài 1900 2030 để được hỗ trợ.</p>
                        <p>(*) Nếu quý khách có nhu cầu trung chuyển, vui lòng liên hệ Tổng đài trung chuyển 1900 4841
                            trước khi đặt vé. Chúng tôi không đón/trung chuyển tại những điểm xe trung chuyển không thể
                            tới được.</p>
                        <div class="mt-3">
                            <label class="label">
                                <input id="acceptTerms" type="checkbox" class="checkbox">
                                <strong>Chấp nhận điều khoản</strong> đặt vé &amp; chính sách bảo mật thông tin của
                                Route3Go
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </main>
</body>

</html>
